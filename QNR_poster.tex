% Gemini theme
% https://github.com/anishathalye/gemini

\documentclass[final]{beamer}

% ====================
% Packages
% ====================

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[size=custom,width=120,height=72,scale=1.0]{beamerposter}
\usetheme{gemini}
% \usecolortheme{gemini}
\usecolortheme{mit}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.14}

\usepackage{xspace}
\xspaceaddexceptions{]\{\}}
\usepackage{complexity}
\usepackage[clean]{svg}
\input{draper_commands.tex}
\providecommand{\QNR}{\csword{QNR}}
\providecommand{\QNRs}{\csword{QNR}s}
\providecommand{\ii}{\left[\jacobi{x}{17}=-1\right]}

% ====================
% Lengths
% ====================

% If you have N columns, choose \sepwidth and \colwidth such that
% (N+1)*\sepwidth + N*\colwidth = \paperwidth
\newlength{\sepwidth}
\newlength{\colwidth}
\newlength{\circwidth}
\setlength{\sepwidth}{0.025\paperwidth}
\setlength{\colwidth}{0.2\paperwidth}
\setlength{\circwidth}{0.04\paperwidth}

\newcommand{\separatorcolumn}{\begin{column}{\sepwidth}\end{column}}

% ====================
% Title
% ====================

\title{Evaluating NISQ Devices with Quadratic Nonresidues}

% \author{Thomas G. Draper \inst{1}}
\author{Thomas G. Draper}

% \institute[shortinst]{\inst{1} Center for Communications Research at La Jolla}
\institute[shortinst]{Center for Communications Research at La Jolla}

% ====================
% Footer (optional)
% ====================

\footercontent{
  \href{https://www.ccrwest.org}{https://www.ccrwest.org} \hfill
  Quantum Information Processing 2022, Pasadena, CA \hfill
  \href{mailto:tdraper@ccrwest.org}{tdraper@ccrwest.org}}
% (can be left out to remove footer)

% ====================
% Logo (optional)
% ====================

% use this to include logos on the left and/or right side of the header:
\logoleft{\includegraphics[height=4cm]{IDALogo.png}}
\logoright{\includegraphics[height=6cm]{TreeLogo}}

% \logoright{\includegraphics[height=4cm]{tree.png}\raisebox{.8cm}{\bf\Huge CCR LA JOLLA}}

% ====================
% Body
% ====================

\begin{document}

\begin{frame}[t]
% \includegraphics[width=\textwidth]{qnr17_nn.pdf}

\begin{columns}[t]
\separatorcolumn

\begin{column}{\colwidth}

  \begin{block}{An unsolved problem since Gauss}
  \begin{minipage}[c]{0.3\colwidth}
    \includegraphics[width=.25\colwidth]{gauss.jpeg}
  \end{minipage}
  \begin{minipage}[l]{0.7\colwidth}
    \heading{Quadratic nonresidue problem (\csword{QNR}):}
    \bigskip

    Given a prime $p\equiv 1\bmod 8$, find a $y$ such that $x^2\equiv y \bmod p$ has no solution.  

    \bigskip
  {\bf Question:} Is \QNR in \xP?
    \bigskip
  \end{minipage}

Gauss~\cite{gauss} proved the first nontrivial upper bound for the least quadratic nonresidue showing that $y<2\sqrt{p}+1$.
Current best analytic tools prove that $y < C\cdot p^\alpha$ for a non-zero $\alpha$~\cite[p. 33]{1993--cohen}.
  \end{block}

  \begin{exampleblock}{\QNR is in \EQPC}

\begin{algorithm}
  \caption{
    % {\bf Exact quantum polynomial time algorithm for finding a quadratic nonresidues for $p\equiv 1 \bmod 8$.}
    Given $p\equiv 1 \bmod 8$, 
  choose least $n$ where $p<2^n=N$. 
    Let $\theta=\mbox{arccos}\left(1-\frac{2^n}{p-1}\right)$, and
    $f(x)=\left[\jacobi{x}{p}=-1\text{ and } 0\le x<p\right]$.
    % Let $n, N, \theta, x_0 \text{ and } f(x)$ be defined as in section~\ref{qc_alg}.
    % Let $f$ be as defined in equation~\eqref{indicator} and $\theta=\mbox{arccos}\left(1-\frac{N}{p-1}\right)$.
}
  \label{quantum_qnr}
  \begin{noindqlist}
  \item $[O(n)]$ Apply $H^{\otimes n}$ to \( \ket{0}^{\otimes n} \) (Hadamard transform).
    \[ \frac{1}{\sqrt{N}}\sum_{x=0}^{N-1} \ket{x} \]
  \item $[O(n\log^2 n)]$ Compute Jacobi symbol indicator~\cite{harvey:hal-02070778,DBLP:journals/corr/abs-1004-2091}.
\[\frac{1}{\sqrt{N}} \sum_{x=0}^{N-1} \ket{x}\ket{\left[\jacobi{x}{p}=-1\right]}\]
\item $[O(n)]$ Compute $[x<p]$ indicator~\cite{comparator}.
\[\frac{1}{\sqrt{N}} \sum_{x=0}^{N-1} \ket{x}\ket{\left[\jacobi{x}{p}=-1\right]}\ket{[x<p]}\]
  \item $[O(1)]$ Rotate odd QNRs less than $p$ by $-2\theta$.
  % \item $[O(1)]$ Rotate odd QNRs less than $p$ by $-2\theta$, conditioned on $[x<p],\left[\jacobi{x}{p}=-1\right],$ and $x_0$.
  \[\frac{1}{\sqrt{N}} \sum_{x=0}^{N-1} e^{-i2\theta f(x)x_0}\ket{x}\ket{\left[\jacobi{x}{p}=-1\right]}\ket{[x<p]}\]
\item $[O(1)]$ Rotate all QNRs less than $p$ by $\theta$.
% \item $[O(1)]$ Rotate all QNRs less than $p$ by $\theta$, conditioned on $[x<p]$ and $\left[\jacobi{x}{p}=-1\right]$.
  \[\frac{1}{\sqrt{N}} \sum_{x=0}^{N-1} e^{i\theta f(x)(1-2x_0)}\ket{x}\ket{\left[\jacobi{x}{p}=-1\right]}\ket{[x<p]}\]
\item $[O(n\log^2 n)]$ Uncompute indicator functions.
  \[\frac{1}{\sqrt{N}} \sum_{x=0}^{N-1} e^{i\theta f(x)(1-2x_0)}\ket{x}\]
\item $[O(n)]$ Use a Grover step to invert about the mean $\alpha=\frac{1}{2\sqrt{N}}$.
    \[ \frac{1}{\sqrt N}\sum_{x=0}^{N-1} \left(1-e^{i\theta f(x) (1-2x_0)}\right)\ket{x} \]
  \item $[O(n)]$ Observe a quadratic nonresidue modulo $p$.
  \end{noindqlist}
\end{algorithm}

  \end{exampleblock}
\end{column}

\separatorcolumn

\begin{column}{\colwidth}

  \begin{block}{Phase inversion in the \QNR algorithm}
      \centering
    \begin{figure*}
      \includegraphics[width=.3\colwidth]{41polar_1.pdf}
    \hfill\includegraphics[width=.3\colwidth]{41polar_2.pdf}
    \hfill\includegraphics[width=.3\colwidth]{41polar_3.pdf}
      \caption{Amplitude values for Quadratic Nonresidues for $p=41$}
    \end{figure*}

  \end{block}

  \begin{exampleblock}{Creating a NISQ test from the \QNR algorithm}
    Using a single Jacobi symbol calculation, a quantum computer can find a \QNR 100\% of the time, 
    whereas a classical computer can only succeed 75\% of the time.

    Even if we want to argue for a different classical bound, without a mathematical breakthrough,
    the provable success rate of any algorithm in \xP will always be less than 100\%.

    The \QNR algorithm evaluates two NISQ properties:
    % Furthermore, note that the \QNR algorithm produces an equal superposition of \QNR states.
    % This allows two separate NISQ tests:
    \begin{itemize}
      \item The rate of success.
      \item The uniformity of the observations.
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Jacobi symbol permutation for $p=17$}
  For Fermat primes ($p=2^{2^n}+1$), the inequality indicator $[p<x]$, and be left out since there are only $2^{2^n}$ nonzero residues.

    Additionally, a permutation of $0,1,\ldots ,2^{2^n}-1$ exists where one of the output wires is the parity bit, and another is the indicator function for the Jacobi symbol.
 $$[\jacobi{x}{17}=-1]=x_0x_1+x_0x_2+x_1x_2+x_1x_3+x_2x_3+x_0x_1x_3$$

      \heading{Indicator permutation for $p=17$}
 \begin{center}
    \begin{figure*}
      \includegraphics[width=.8\colwidth]{H4_box_qnr17_indicator.pdf}
    \end{figure*}
 \end{center}

    Ideally, the Jacobi symbol circuit should be derived from an algorithm, and not by computer search.
    Given the current shortcomings of current NISQ devices, a full algorithm, even at the $p=17$ level is hard to distinguish from random. 

    As NISQ devices improve, a full algorithmic test for $p=17$ will be meaningful.
    The next tests of interest will likely be $p=41$ and $p=257$.

  \end{block}


\end{column}

\separatorcolumn

\begin{column}{\colwidth}

  \begin{block}{Basic QNR circuit  for $p=17$}

      \centering
    \begin{figure*}
      \includegraphics[width=\colwidth]{qnr17_full_circuit.pdf}
      % \caption{QNR test for $p=17$}
    \end{figure*}

  \end{block}

  \begin{block}{Transpiled subcircuits}
    Two properties are required circuit to run on all of the tested NISQ devices:
    \begin{itemize}
      \item Only single qubit gates and \CNOTs.
      \item All \CNOTs are nearest neighbor.
    \end{itemize}

    \heading{Inverse indicator permutation decomposition}
    Since a \CNOT or \CCNOT targeting a $\ket{+}$ does nothing, the entire forward pass of the indicator permutation can be removed.
    The backwards pass was constructed using ideas from Gidney~\cite{3957}. 
      % \caption{Indicator function decomposition}
    \begin{figure*}
      \includegraphics[width=\colwidth]{qnr17_indicator_T.pdf}
    \end{figure*}

    \heading{Grover gate decomposition}
    A new method was discovered to flip the $\ket{0000}$ state without using an extra qubit.%\cite{QNR_NISQ}

    \begin{figure*}
      \includegraphics[width=\colwidth]{zero_flip_p16.pdf}
    \end{figure*}

  \end{block}
  \begin{exampleblock}{QNR test advantages}
\begin{itemize}
  \item {\bf Implementation agnostic}
  \item {\bf Infinite tests} 
  \item {\bf Ease of execution}
  \item {\bf Better comparison}
\end{itemize}
  \end{exampleblock}


  \begin{block}{References}
    % \nocite{*}
    % \footnotesize{\bibliographystyle{abbrv}\bibliography{QNR_poster}}
    {\fontsize{15pt}{15pt}\selectfont
\begin{thebibliography}{100} % 100 is a random guess of the total number of
%references
  \bibitem{gauss} Carl Friedrich Gauss, \emph{Disquisitones arithmeticae}, 1801.
  \bibitem{1993--cohen} H. Cohen, \emph{A course in computational algebraic number theory}, Springer-Verlag, Berlin, 1993.

  \bibitem{harvey:hal-02070778} D. Harvey, J. Van Der Hoeven, \emph{{Integer multiplication in time $O(n \log n)$}}, {{Annals of Mathematics}}, {{Princeton University, Department of Mathematics}}, 2020.

\bibitem{DBLP:journals/corr/abs-1004-2091} R. P. Brent and P. Zimmerman, \emph{An {$O(M(n) \log n)$} algorithm for the Jacobi symbol}, {CoRR}, 2010.

    \bibitem{comparator} {D. Oliveira, R. Ramos},\emph{Quantum bit string comparator: Circuits and applications}, {Quantum Computers and Computing}, Vol.7, 2007.
  \bibitem{3957} C. Gidney, \emph{Minimum number of CNOTs for Toffoli with non-adjacent controls (answer:3964)}, {https://quantumcomputing.stackexchange.com}, 2018. 
% \bibitem{Boney96} Boney, L., Tewfik, A.H., and Hamdy, K.N., ``Digital
% Watermarks for Audio Signals," \emph{Proceedings of the Third IEEE
% International Conference on Multimedia}, pp. 473-480, June 1996.
% \bibitem{MG} Goossens, M., Mittelbach, F., Samarin, \emph{A LaTeX
% Companion}, Addison-Wesley, Reading, MA, 1994.
% \bibitem{HK} Kopka, H., Daly P.W., \emph{A Guide to LaTeX},
% Addison-Wesley, Reading, MA, 1999.
% \bibitem{Pan} Pan, D., ``A Tutorial on MPEG/Audio Compression," \emph{IEEE
% Multimedia}, Vol.2, pp.60-74, Summer 1998.
\end{thebibliography}
}
  \end{block}

\end{column}
\separatorcolumn

\begin{column}{\colwidth}
  \begin{block}{Test results for $p=17$ \hspace{1ex}  (Jun-Aug 2021)}
    \heading{Success rates of 1000 shot runs}
    % \raisebox{1mm}[0pt][0pt]{%
      % \makebox[\colwidth][c]{%
    \includegraphics[width=\colwidth]{nisq_stripplot.pdf}
    % }}
    \heading{$p$-values of uniformity test for 1000 shot runs}
    \includegraphics[width=\colwidth]{nisq_pvalue_logit.pdf}
    \heading{Success rate vs. $p$-value}
    \includegraphics[width=\colwidth]{nisq_scatter.pdf}

  \end{block}


\end{column}

\separatorcolumn

\begin{column}{\circwidth}
  \begin{block}{QNR17 Test}
    \includegraphics[width=1.1\circwidth]{V4_qnr17_nn.pdf}
  \end{block}

\end{column}

\separatorcolumn
\end{columns}
\end{frame}

\end{document}
